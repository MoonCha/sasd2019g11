#!/usr/bin/env python
from __future__ import print_function

import pwn
import os

pwn.context.terminal = "tmux splitw -v".split()
pwn.context.arch="amd64"

os.chdir("./hook_dir")

r = pwn.process("../main.elf")
# r = pwn.gdb.debug("./main.elf")

r.recvuntil("Loading user data...\n")
flag = r.recvline(timeout=60)
print(flag)
r.close()

os.chdir("../")

f = open("./solution.txt", "w")
f.write(flag)
f.close()

