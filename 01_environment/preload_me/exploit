#!/usr/bin/env python
from __future__ import print_function

import pwn


pwn.context.terminal = "tmux splitw -v".split()
pwn.context.arch="amd64"

r = pwn.process("./main.elf", env={ "LD_PRELOAD":"./hook.so" })
# r = pwn.gdb.debug("./main.elf")

r.recvuntil("The output is: ")

flag = r.recvline(timeout=60)
print(flag)
r.close()

f = open("./solution.txt", "w")
f.write(flag)
f.close()

