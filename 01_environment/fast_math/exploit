#!/usr/bin/env python
from __future__ import print_function

import pwn
import os
import time


pwn.context.terminal = "tmux splitw -v".split()
pwn.context.arch="amd64"

delay=0
flag=""

for i in range(0, 100):
  delay += 0.01
  os.system("ln -sf ./sum hook")
  r = pwn.process(("./main.elf hook 250000").split())
  # r = pwn.gdb.debug("./main.elf")
  print(r.recv())

  time.sleep(delay)
  os.system("rm hook; cp reader hook")

  flag = r.recv(timeout=60)
  print(flag)
  r.close()
  if flag.find("SASD") != -1:
    break;

f = open("./solution.txt", "w")
f.write(flag)
f.close()

